
local objects={}
local mon

function init(monside)
	mon = peripheral.wrap(monside)
end

function clear()
	mon.setBackgroundColor(colors.black)
	mon.clear()
end

function redraw()
	clear()
	for k,o in pairs(objects) do
		if(o ~= nil) then
		o.draw()
		end
	end
end
function touchWait ()
event, touch, x, y = os.pullEvent("monitor_touch")
	for k,o in pairs(objects) do
		if(o ~= nil) then
			o.isClicked(x,y)
		end
	end
end


button = {}
function button.new (atext,acolor,ax,ay,acallback)
	local self = {}
	local callback=acallback
	local text = atext
	local color= acolor
	local x=ax
	local y=ay
	local key=0
	function self.isClicked(cx,cy)
		if(((cy >= y and cy <= y+2) and ( cx >= x and cx<= x+string.len (text)+2)))then
		local tcol=color
		color=colors.red
		self.draw()
		callback()
		sleep(0.1)
		color=tcol
		self.draw()
		end
	end
	function self.draw()
		mon.setBackgroundColor(color)
		
		mon.setCursorPos(x,y)
		mon.write(string.rep(" ",string.len (text)+2))
		
		mon.setCursorPos(x,y+1)
		mon.write(" "..text.." ")
		
		mon.setCursorPos(x,y+2)
		mon.write(string.rep(" ",string.len (text)+2))
	end
	
	function self.delete()
		objects[key]=nil
	end
	
	table.insert(objects,self)
	
	key= table.maxn(objects)
	
	return self
end

graph = {}

function graph.new(atitle,axtable,aytable,aposx,aposy,awidth,aheight)
	local self= {}
	local title= atitle
	local xtable=axtable
	local ytable=aytable
	local posx=aposx
	local posy=aposy
	local width=awidth
	local height=aheight
	local key=0
	function self.draw()
		term.redirect(mon)
		paintutils.drawLine(posx,posy,posx+width,posy,colors.white)
		paintutils.drawLine(posx,posy+height,posx+width,posy+height,colors.white)
		paintutils.drawLine(posx,posy,posx,posy+height,colors.white)
		paintutils.drawLine(posx+width,posy,posx+width,posy+height,colors.white)
		sleep(5)
		term.restore()
	end
	function self.isClicked(cx,cy)
		--if(((cy >= y and cy <= y+2) and ( cx >= x and cx<= x+string.len (text)+2)))then
		--callback()
		--end
	end
	
	function self.delete()
		objects[key]=nil
	end
	
	table.insert(objects,self)
	
	key= table.maxn(objects)
	
	return self
end

--local b = button.new ("right","test",colors.green,2,2)
--b.draw()